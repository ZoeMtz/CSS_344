<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Manage Products | Sweetleaf & Co.</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="assets/favicon.ico" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap" rel="stylesheet">
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="index.html">Sweetleaf & Co.</a>
      <div class="ms-auto">
        <a href="dashboard.html" class="btn btn-outline-light">Admin</a>
      </div>
    </div>
  </nav>

  <!-- Product Management -->
  <div class="container my-5">
    <h2 class="text-center mb-4">Manage Products</h2>
    <div class="row justify-content-center">
      <div class="col-md-8">
        <form id="addForm" class="card p-4 shadow-sm mb-4">
          <input id="productName" type="text" class="form-control mb-2" placeholder="Product Name" required>
          <input id="productPrice" type="number" class="form-control mb-2" placeholder="Price" required>
          <input id="productImage" type="text" class="form-control mb-2" placeholder="Image filename (e.g. chamomile.jpg)">
          <textarea id="productDescription" class="form-control mb-2" placeholder="Description"></textarea>
          <button class="btn btn-success">Add Product</button>
        </form>

        <ul id="productList" class="list-group"></ul>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="text-center py-4">
    <p>Tea manager panel üçÉ ‚Äî Keep the blends balanced.</p>
  </footer>

  <!-- Script -->
  <script>
    if (localStorage.getItem("loggedIn") !== "true") {
      window.location.href = "login.html";
    }

    const list = document.getElementById("productList");
    let products = JSON.parse(localStorage.getItem("manageProducts") || "[]");

    function render() {
      list.innerHTML = "";
      products.forEach((p, i) => {
        list.innerHTML += `<li class="list-group-item">
          <strong>${p.name}</strong> - $${p.price}<br>
          <img src="images/${p.image}" width="100" class="my-2"><br>
          <small>${p.description}</small><br>
          <button onclick="edit(${i})" class="btn btn-sm btn-warning mx-1">Edit</button>
          <button onclick="remove(${i})" class="btn btn-sm btn-danger">Delete</button>
        </li>`;
      });
      localStorage.setItem("manageProducts", JSON.stringify(products));
    }

    function remove(i) {
      products.splice(i, 1);
      render();
    }

    function edit(i) {
      const p = products[i];
      const newName = prompt("Edit name:", p.name);
      const newPrice = parseFloat(prompt("Edit price:", p.price));
      const newImage = prompt("Edit image filename:", p.image);
      const newDesc = prompt("Edit description:", p.description);
      if (newName && !isNaN(newPrice)) {
        products[i] = { ...p, name: newName, price: newPrice, image: newImage, description: newDesc };
        render();
      }
    }

    document.getElementById("addForm").onsubmit = function(e) {
      e.preventDefault();
      const newProduct = {
        id: Date.now(),
        name: productName.value,
        price: parseFloat(productPrice.value),
        image: productImage.value,
        description: productDescription.value
      };
      products.push(newProduct);
      productName.value = "";
      productPrice.value = "";
      productImage.value = "";
      productDescription.value = "";
      render();
    };

    render();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
